(function(b){b(document).ready(function(){function m(){var a=this,e=[function(d){var c=b.Deferred();d.animate({top:a._position.bottom,opacity:"hide"},c.resolve);return c.promise()},function(d){var a=b.Deferred();d.fadeOut(1E3,a.resolve);return a.promise()}];return e[Math.floor(Math.random()*e.length)]}function j(a){var e=this,d=this.options.effect==="random"?b.fn.textualizer.effects[g[Math.floor(Math.random()*g.length)]]:b.fn.textualizer.effects[this.options.effect],c=b.Deferred(),f=[];b.each(a.chars,
function(a,b){b.inserted||(b.domNode.show().css({left:b.pos.left,top:b.pos.top}).delay(Math.random()*i),d.call(e,b),f.push(b.domNode))});b.when.apply(null,f).done(function(){c.resolve()});return c.promise()}var i=2E3;b.fn.textualizer=function(a,e){var d=arguments,c=function(a){var c=a.data("textualizer");if(!c){var c=[],e;if(d.length===1&&d[0]instanceof Array)c=d[0];else if(d.length===1&&typeof d[0]==="object")e=d[0];else if(d.length===2)c=d[0],e=d[1];else throw"textualizer: invalid argument(s)";
e=b.extend({},b.fn.textualizer.defaults,e);c=new h(a,c,e);a.data("textualizer",c)}return c}(this);typeof d[0]==="string"&&c[d[0]]&&c[d[0]].apply(c,Array.prototype.slice.call(d,1));return this};b.fn.textualizer.defaults={effect:"random",duration:500,rearrangeDuration:1E3};b.fn.textualizer.effects={none:function(a){this.container.append(a.domNode.show())},fadeIn:function(a){this.container.append(a.domNode.fadeIn(2E3))},slideLeft:function(a){a.domNode.appendTo(this.container).css({left:-1E3}).animate({left:a.pos.left},
2E3)},slideTop:function(a){a.domNode.appendTo(this.container).css({top:-1E3}).animate({top:a.pos.top},2E3)}};var g=[];b.each(b.fn.textualizer.effects,function(a){a!=="none"&&g.push(a)});var k=function(){this.str="";this.chars=[]};k.prototype={get:function(a){for(var b=0,d=this.chars.length;b<d;b++){var c=this.chars[b];if(c.ch===a&&!c.used)return c.used=!0,c}return null},reset:function(){b.each(this.chars,function(a,b){b.inserted=!1;b.used=!1})}};var n=function(){this.pos=this.domNode=this.ch=null;
this.visited=this.inserted=this.used=!1},h=function(a,e,d){this.options=d;this._parent=a.parent();var c=a.clone().removeAttr("id").appendTo(document.body),f=window.getComputedStyle(a[0],null);b.each(f,function(b,a){c.css(a,f.getPropertyValue(a))});c.css({position:"absolute",top:"-1000px"});this.phantomContainer=b("<div />").css({position:"relative",visibility:"hidden"}).appendTo(c);a.css("overflow","hidden");this.container=b("<div />").css("position","relative").appendTo(a);this._previous=null;this._position=
this._parent.position();this._position.bottom=this._position.top+this._parent.height();this.blurbs=[];e&&e instanceof Array&&this.data(e)};h.prototype={data:function(b){this.stop();this.list=b;this.blurbs=[]},start:function(){function a(c){e._pause||e._rotate(c).done(function(){setTimeout(function(){c===e.list.length-1&&(c=-1,b.each(e.blurbs,function(b,a){a.reset()}));c++;e._index=c;a(c)},e.options.duration)})}if(this.list&&this.list.length!==0){var e=this,d=this._index||0;this._pause=!1;a(d)}},stop:function(){this.pause();
this._previous=null;this._index=0;this.container.empty();this.phantomContainer.empty()},pause:function(){this._pause=!0},_rotate:function(a){var e=b.Deferred(),d=this.blurbs[a];if(!d){var c=[],d=new k;d.str=this.list[a];this.blurbs.push(d);b.each(d.str,b.proxy(function(a,d){if(d==="")this.phantomContainer.append(" ");else{var e=new n;e.ch=d;e.domNode=b("<span/>").text(d);this.phantomContainer.append(e.domNode);c.push(e)}},this));b.each(c,function(b,a){a.pos=a.domNode.position();a.domNode=a.domNode.clone();
a.domNode.css({left:a.pos.left,top:a.pos.top,position:"absolute"});d.chars.push(a)});this.phantomContainer.html("")}if(this._previous){var f=this,g=[],h=[],l=[],i=m.call(this);b.each(this._previous.chars,function(a,c){var e=d.get(c.ch);if(e)e.domNode=c.domNode,e.inserted=!0,g.push(e);else{var f=b.Deferred();h.push(f);i(c.domNode.delay(Math.random()*2E3)).done(function(){c.domNode.remove();f.resolve()})}});b.when.apply(null,h).done(function(){setTimeout(function(){b.each(g,function(a,b){b.domNode.animate({left:b.pos.left,
top:b.pos.top},f.options.rearrangeDuration);l.push(b.domNode)});b.when.apply(null,l).done(function(){setTimeout(function(){j.call(f,d).done(function(){e.resolve()})},500)})},1E3)})}else j.call(this,d).done(function(){e.resolve()});this._previous=d;return e.promise()},destroy:function(){this.container.parent().removeData("textualizer").end().remove();this.phantomContainer.remove()}}})})(jQuery);